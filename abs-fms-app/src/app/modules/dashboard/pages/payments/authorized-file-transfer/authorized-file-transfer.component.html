<div class="container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="title-section">
      <h2>Authorized Payments</h2>
      <p>Search and manage payments for claims, commissions, policy maturity, etc</p>
    </div>
  </div>

  <!-- Search and Filter Section -->
  <div class="search-filter-section">
    <form [formGroup]="searchForm" class="search-form">
      <div class="search-row">

         <!-- Type Filter -->
        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Type</mat-label>
          <mat-select formControlName="type">
            <mat-option *ngFor="let option of typeOptions" [value]="option.value">
              {{ option.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Date Range Row -->
      <div class="date-row">
        <mat-form-field appearance="outline" class="date-field">
          <mat-label>Date From</mat-label>
          <input matInput [matDatepicker]="dateFromPicker" formControlName="dateFrom">
          <mat-datepicker-toggle matSuffix [for]="dateFromPicker"></mat-datepicker-toggle>
          <mat-datepicker #dateFromPicker></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="outline" class="date-field">
          <mat-label>Date To</mat-label>
          <input matInput [matDatepicker]="dateToPicker" formControlName="dateTo">
          <mat-datepicker-toggle matSuffix [for]="dateToPicker"></mat-datepicker-toggle>
          <mat-datepicker #dateToPicker></mat-datepicker>
        </mat-form-field>
      </div>


        <!-- Search Input with Autocomplete -->
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search Transfers</mat-label>
          <input matInput formControlName="searchTerm"
                 placeholder="Search by voucher, narrative, remarks, or payee"
                 [matAutocomplete]="auto">
          <mat-icon matSuffix>search</mat-icon>
          <mat-autocomplete #auto="matAutocomplete"
                           [displayWith]="displayTransfer.bind(this)"
                           (optionSelected)="onTransferSelected($event.option.value)">
            <mat-option *ngFor="let transfer of filteredTransfers | async" [value]="transfer">
              <div class="transfer-option">
                <div class="transfer-header">
                  <span class="voucher-ref">{{ transfer.voucherNoRef }}</span>
                  <span class="type-badge type-{{ transfer.type.toLowerCase() }}">
                    {{ getTypeLabel(transfer.type) }}
                  </span>
                </div>
                <div class="transfer-details">
                  <span class="narrative">{{ transfer.narrative }}</span>
                </div>
                <div class="transfer-meta">
                  <span class="amount">{{ formatCurrency(transfer.amountPayee, transfer.currencyCode) }}</span>
                  <span class="date">{{ transfer.date | date:'dd/MM/yyyy' }}</span>
                </div>
              </div>
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <!-- Type Filter -->
        <!-- <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Type</mat-label>
          <mat-select formControlName="type">
            <mat-option *ngFor="let option of typeOptions" [value]="option.value">
              {{ option.label }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->



        <!-- Clear Filters Button -->
        <!-- <button mat-stroked-button type="button" (click)="clearFilters()" class="clear-btn">
          <mat-icon>clear</mat-icon>
          Clear Filters
        </button> -->
      </div>

      
    </form>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Loading transfers...</p>
  </div>

  <!-- Instructions -->
  <div class="instructions-section" *ngIf="!isLoading">
    <mat-card class="instructions-card">
      <mat-card-content>
        <div class="instructions-content">
          <mat-icon class="instructions-icon">info</mat-icon>
          <div class="instructions-text">
            <h3>How to Search</h3>
            <p>Use the search field above to find authorized file transfers. You can search by:</p>
            <ul>
              <li>Voucher number or reference</li>
              <li>Narrative or description</li>
              <li>Remarks</li>
              <li>Authorized by or prepared by names</li>
              <li>Bank account information</li>
            </ul>
            <p>Apply filters by type, or date range to narrow your search. Select a transfer from the dropdown to view full details.</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
